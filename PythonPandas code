import os
import pandas as pd
from tabulate import tabulate

# Specify the path to your .txt file and the output Parquet file
file_path = r'C:\Users\MarioArevilca\PythonPractice\num.txt'
output_parquet_path = r'C:\Users\MarioArevilca\PythonPractice\num.parquet'

# Set the maximum number of rows to display
pd.set_option('display.max_rows', 20)  # Adjust this number as needed for display purposes

# Load the data into a DataFrame, adjust the delimiter as needed
df = pd.read_csv(file_path, delimiter='\t', engine='python')  # Use engine='python' for complex delimiters

# Format the 'value' column as currency if needed
df['value'] = df['value'].apply(lambda x: '${:,.2f}'.format(x))

# Optionally, you can clean up whitespace from strings
df = df.applymap(lambda x: x.strip() if isinstance(x, str) else x)

# Display the DataFrame using tabulate for better formatting (for checking the result)
print(tabulate(df.head(20), headers='keys', tablefmt='grid'))

# Save the DataFrame as a Parquet file
df.to_parquet(output_parquet_path, index=False)
print(f"Data successfully saved to {output_parquet_path}")

# Load the Parquet file into a DataFrame to verify
df_parquet = pd.read_parquet(output_parquet_path)

# Display the DataFrame from Parquet file using tabulate for better formatting
print(tabulate(df_parquet.head(20), headers='keys', tablefmt='grid'))
